loki:
  schemaConfig:
    configs:
      - from: 2024-06-01
        store: tsdb
        object_store: filesystem  # filesystem for local storage
        schema: v12               # âœ… Fixed: use valid schema version
        index:
          prefix: loki_index_
          period: 24h

  ingester:
    chunk_encoding: snappy  # Define chunk encoding for ingester

  tracing:
    enabled: true  # Enable tracing for Loki

  querier:
    max_concurrent: 4  # Max concurrent queries

deploymentMode: SimpleScalable  # Set deployment mode for scalable Loki setup

# Number of replicas for different components in the Loki deployment
backend:
  replicas: 3  # Replicas for backend components

read:
  replicas: 3  # Replicas for read components

write:
  replicas: 3  # Replicas for write components

minio:
  enabled: false  # Disable Minio, as we're using local storage

singleBinary:
  replicas: 0  # Single binary mode is disabled

ingester:
  replicas: 1  # Number of ingester replicas

querier:
  replicas: 1  # Number of querier replicas

queryFrontend:
  replicas: 1  # Number of queryFrontend replicas

distributor:
  replicas: 1  # Number of distributor replicas

compactor:
  replicas: 0  # No need for compactor unless scaling

indexGateway:
  replicas: 0  # No need for indexGateway unless scaling

bloomCompactor:
  replicas: 0  # No need for bloomCompactor unless scaling

bloomGateway:
  replicas: 0  # No need for bloomGateway unless scaling

# Ingress configuration
ingress:
  enabled: true  # Set to true to enable ingress
  host: loki.cloudmasa.com  # Set your actual hostname here
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: "/"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  ingressClassName: "nginx"

# Persistent storage configuration
persistence:
  enabled: true
  storageClassName: "manual"  # Match this with your PV's storageClassName
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi

# Resources section
resources:
  limits:
    cpu: "1"
    memory: "2Gi"
  requests:
    cpu: "500m"
    memory: "1Gi"
